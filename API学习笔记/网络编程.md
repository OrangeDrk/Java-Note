[TOC]

# 网络通信基础

> 端口对象：套接字
>
> - 客户端套接字：Socket
>
> - 服务器套接字：SeverSocket
> - Socket套接字：
> 		网络上具有唯一标识的IP地址和端口号组合在一起才能构成唯一能识别的标识符套接字。
> - Socket原理机制：
> 		通信的两端都有Socket。网络通信其实就是Socket间的通信。数据在两个Socket间通过IO传输。
> - 应用程序通常通过“套接字”向网络发出请求或者应答网络请求。Socket和ServerSocket类位于java.net包中。ServerSocket用于服务端，Socket是建立网络连接时使用的。在连接成功时，应用程序两端都会产生一个Socket实例，操作这个实例，完成所需的会话。
>
> 网络通信三要素：
>
> - IP地址：InetAddress
> - 端口号：用于标识进程的逻辑地址，不同进程的标识不同
> - 传输协议：通讯的规则
>   - 常见协议：TCP
>   - FTP：常用于上传下载
>   - HTTP：门户网站，大量用户访问
>
> 端口号：
>
> ​		每个网络程序都会至少有一个逻辑端口
> ​		用于标识进程的逻辑地址，不同进程的标识
> ​		有效端口：0-65535，其中0~1024系统使用或保留端口。
>
> 获取IP地址的相关方法：`InetAddress`类的使用
>
> - 获取主机对象：`getLocalHost()`
> - 主机名：`getHostName()`
> - 主机Ip地址：`getHostAddress()`
>
> ```java
> package wangluo;
> 
> import java.io.IOException;
> import java.net.InetAddress;
> 
> public class InetAddressDemo {
> 
> 	public static void main(String[] args) throws IOException {
> 		//获取本机主机对象
> 		InetAddress address = InetAddress.getLocalHost();
> 		System.out.println(address);
> 		
> 		//获取本机主机名
> 		String name = address.getHostName();
> 		System.out.println(name);
> 		
> 		//获取本机IP地址字符串表示
> 		String ip = address.getHostAddress();
> 		System.out.println(ip);
> 		
> 	}
> 
> }
> 
> ```
>
> 



> TCP通信：客户端和服务器端
>
> 服务器端：
>
> - 1.定义服务器端套接字，并初始化
> - 2.调用accept方法等待客户端的连接，并返回socket对象
> - Socket socket = server.accept();
> - 3.获取输入流对象InputStream
> - 4.转换成BufferedReader对象
> - 5.读取客户端的 数据，处理数据
> - 6.获取输出流OutputStream
> - 7.转换成PrintWriter对象
> - 8.调用println方法写给客户端

```Java
package tcpdemo;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;

public class Server {
	public static void main(String[] args) {
		ServerSocket server;
		try {
			System.out.println("请求启动服务器……");
			server = new ServerSocket(8088);
			System.out.println("服务器启动完毕！");
			System.out.println("等待客户端连接");
			
			//等待连接，如果接收到客户端的请求，那么返回socket对象
			Socket socket = server.accept();
			System.out.println("一个客户端连接了！");
			
			//获取输入对象
			InputStream in = socket.getInputStream();
			InputStreamReader isr = new InputStreamReader(in,"UTF-8");
			BufferedReader br = new BufferedReader(isr);
			
			//获取客户端的请求信息
			String line = br.readLine();
			System.out.println("客户端说："+line);
			
			//获取输出流对象
			OutputStream out = socket.getOutputStream();
			OutputStreamWriter osw = new OutputStreamWriter(out,"UTF-8");
			PrintWriter pw = new PrintWriter(osw,true);
			
			//响应信息到客户端
			pw.println("服务器："+line);
			
			
			
			
		} catch (IOException e) {
			e.printStackTrace();
		}
		
	}
}

```



> 客户端：
>
>  * 1.定义一个socket对象，初始化
>  * 2.从socket对象对象中，获取输出流对象OutputStream
>  * 3.转换成PrintWriter类型的输出流对象
>  * 4.println发放发送数据到服务器
>  *  。。。。。。。。。。。。。。。。服务器处理数据，并返回给客户端响应
>  * 5.获取输入流InputStream对象
>  * 6.转换成BufferedReader对象
>  * 7.从输入流中获取服务端的数据，并打印输出

```Java
package tcpdemo;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.Socket;

public class Client {

	public static void main(String[] args) {
		Socket socket;
		try {
			
			//定义一个socket对象，初始化
			System.out.println("正在连接服务器……");
			socket = new Socket("localhost",8088);
			System.out.println("与服务器建立连接！");
			
			
			//获取输出流
			OutputStream out = socket.getOutputStream();
			OutputStreamWriter osw = new OutputStreamWriter(out,"UTF-8");
			PrintWriter pw = new PrintWriter(osw,true);
			
			String line = "你好啊";
			//写数据到服务器
			pw.println(line);
			
			//获取输入流对象
			InputStream in = socket.getInputStream();
			InputStreamReader isr = new InputStreamReader(in,"UTF-8");
			BufferedReader br = new BufferedReader(isr);
			
			//从服务器相应回来的数据，并打印输出
			String str = br.readLine();
			System.out.println(str);
			
			
			
			
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

}

```

